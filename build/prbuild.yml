name: $(date:yyyy-MM-dd)$(rev:.rr)
trigger: none
pr: none

jobs:
- job: ValidateReleaseInfo
  pool:
    vmImage: 'vs2017-win2016'
  steps:
  - task: NuGetCommand@2
    displayName: 'NuGet - Octokit install'
    inputs:
      command: custom
      arguments: 'install OctoKit -source "https://api.nuget.org/v3/index.json"'  
    
    - task: PowerShell@2
    displayName: 'Validate release_info.json Files'
    env:
      MyPAT:$(gitPATX)
    inputs:
      targetType: "inline"
      filePath: tools\scripts\ValidateReleaseInfo.ps1
      arguments: '$(Build.Repository.LocalPath)'
      script: # Load the octokit dll
Add-Type -Path ((Get-Location).Path + '\Octokit.0.32.0\lib\net45\Octokit.dll')

# Get a new client with an appropriate product header value
$productHeader = [Octokit.ProductHeaderValue]::new("AIWindows-ReleaseInfoValidation")
$client = [Octokit.GitHubClient]::new($productHeader)
$client.Credentials = [Octokit.Credentials]::new($(gitPATX))
$client.Credentials = [Octokit.Credentials]::new($env:myPAT)


